<!doctype html>
<html>
  <head>
    <meta charset="utf-8">
    <title>AuthLab – Search {% if state == 'poc' %}(Vulnerable){% else %}(Safe){% endif %}</title>
  </head>
  <body>
    <h1>Search {% if state == 'poc' %}(Vulnerable){% else %}(Safe){% endif %}</h1>

    <form method="get" action="/search" autocomplete="off">
      <label>Query <input name="q" value="{{ q }}"></label>
      <button type="submit">Search</button>
    </form>

    <hr>
    <h2>Results for:</h2>
    {% if state == 'poc' %}
      {# Vulnerable branch: autoescape is disabled → reflected XSS #}
      {% autoescape false %}{{ q }}{% endautoescape %}
      {# Alternative (equally dangerous): {{ q | safe }} #}
    {% else %}
      {# Safe branch: rely on Jinja autoescape (default) #}
      {{ q }}
    {% endif %}

    <p><a href="/dashboard">Back to dashboard</a></p>
  </body>
</html>
